---

- job:
    name: 'ci-rpmdiff-comparison'
    node: rpmdiff
    description: |
        RPMdiff comparison job

        Runs RPMdiff comparison of given brew task against latest released package.
    concurrent: true
    display-name: 'ci-rpmdiff-comparison'
    parameters:
      - string:
          name: id
          default: ''
          description: 'Brew task ID'
    wrappers:
      - ansicolor:
          colormap: xterm
      - workspace-cleanup
    builders:
      - shell:
          citool -c -i -o citool-debug.txt
                 jenkins
                 testing-results
                 brew --id $id
                 brew-build-name
                 rpmdiff --type comparison
                 notify-ci-bus
    publishers:
      - archive:
          artifacts: '**/**'
          allow-empty: 'true'
