- job:
    name: 'build-on-commit'
    description: |
        Schedule scratch build after push into staging branch of any dist-git repository.
    concurrent: true
    display-name: 'ci-build-on-commit'
    parameters:
        - string:
            name: repo
            description: 'Component name'
        - string: 
            name: branch
            description: 'Git branch'
    triggers:
      - ci-trigger:
          jms-selector: |
            type = 'dist-git'
            AND namespace = 'rpms'
            AND branch LIKE '%staging%'
    builders:
        - shell: |
            citool -i -o citool-debug.txt build-on-commit --component ${repo} --branch ${branch}
    publishers:
        - archive:
            artifacts: '**/**'
            allow-empty: 'true'
