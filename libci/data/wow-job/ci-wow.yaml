---

- job:
    name: 'ci-wow'
    node: beaker
    description: |
        Run testing via beaker workflow tomorrow.
    concurrent: true
    display-name: 'ci-wow'
    parameters:
      - string:
          name: id
          default: ''
          description: 'Brew task ID.'
      - string:
          name: pipeline_prepend
          default: ''
          description: 'citool options that will be added at the beginning of citool pipeline'
      - string:
          name: pipeline_append
          default: ''
          description: 'citool options that will be added at the end of citool pipeline'
      - string:
          name: guess_distro_options
          default: ''
          description: 'Additional options for guess-distro module'
      - string:
          name: wow_options
          default: ''
          description: 'Additional options for workflow-tomorrow'
      - string:
          name: jobwatch_options
          default: ''
          description: 'Additional options for beaker-jobwatch'
      - string:
          name: notify_email_options
          default: ''
          description: 'Additional options for notify-email module.'
    builders:
      - shell:
          citool -i -o citool-debug.txt
            ${pipeline_prepend}
            envinject
            jenkins
            brew --id $id
            brew-build-name
            guess-distro ${guess_distro_options}
            wow --wow-options "${wow_options}" --jobwatch-options "${jobwatch_options}"
            notify-email --wow-default "{ISSUER}" ${notify_email_options}
            ${pipeline_append}
      - inject:
          properties-file: envinject-citool.props
    publishers:
      - archive:
          artifacts: '**/**'
          allow-empty: 'true'
